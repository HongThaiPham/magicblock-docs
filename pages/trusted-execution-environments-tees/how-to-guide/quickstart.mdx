---
title: "Quickstart"
description: "Enable privacy in any Solana program state account through MagicBlock's ER and Trusted Execution Environment."
---

import Endpoints from "/snippets/endpoints.mdx";
import Validators from "/snippets/validators.mdx";
import Construction from "/snippets/construction.mdx";

import WriteProgramCode from "/snippets/tee-tabs/write-program-code.mdx";
import DelegateCode from "/snippets/tee-tabs/delegate-code.mdx";
import RestrictCode from "/snippets/tee-tabs/restrict-code.mdx";
import DeployCode from "/snippets/tee-tabs/deploy-code.mdx";
import AuthorizeCode from "/snippets/tee-tabs/authorize-code.mdx";
import TestCode from "/snippets/tee-tabs/test-code.mdx";

---

## Process of Privacy upgrade

<Steps>
  <Step title={<a href="#1-write-program">Write your program</a>}>
    Write your Solana program as you normally.
  </Step>
  <Step title={<a href="#2-delegate">Add delegation hooks in your program</a>}>
    Add CPI hooks to delegate, commit and undelegate state accounts through
    Ephemeral Rollup sessions.
  </Step>
  <Step
    title={
      <a href="#3-restrict">
        Add restrictions through permission hooks in your program.
      </a>
    }
  >
    Add CPI hooks that create groups and permissions that enable restrictions
    for specific delegated accounts.
  </Step>
  <Step title={<a href="#4-deploy">Deploy your program on Solana</a>}>
    Deploy your Solana program using Anchor CLI.
  </Step>
  <Step
    title={<a href="#5-authorize">Implement authorization in your client</a>}
  >
    Sign user message to retrieve authorization token from TEE endpoint.
  </Step>
  <Step title={<a href="#6-test">Execute transactions and test privacy</a>}>
    Request for authorization token and send confidential transactions.
  </Step>
</Steps>

---

## Private Transfer Example

Find the full private transfer example with Anchor framework and client implementation:

<CardGroup cols={2}>
  <Card
    title="Private Transfer Repo"
    icon="github"
    href="https://github.com/magicblock-labs/private-payments-demo"
    iconType="duotone"
  >
    Full repo for TEE Private Transfer including program and frontend
  </Card>
  <Card
    title="Private Transfer dApp"
    icon="shield-check"
    href="https://private-payments.magicblock.app"
    iconType="duotone"
  >
    Make private transfers
  </Card>
</CardGroup>

<Tabs>
    <Tab title="1. Write program">
        A simple transfer program where tokens are tracked through deposit accounts, and locked in a vault account:
        <WriteProgramCode />
        [⬆️ Back to Top](#private-transfer-example)
    </Tab>
    <Tab title="2. Delegate">
        > `Delegation` is the process of transferring ownership of one or more of your program's `PDAs` to the delegation program. Ephemeral Validators will then be able to use the `PDAs` to perform transactions in the SVM runtime.

        > `Undelegation` is the process of transferring ownership of the `PDAs` back to your program. On undelegation, the state is committed and it trigger the finalization process. Once state it validated, the `PDAs` are unlocked and can be used as normal on mainnet

        Specify your preferred delegation config such as auto commits and specific ER validator:
        <Validators />
        <DelegateCode />
        [⬆️ Back to Top](#private-transfer-example)
    </Tab>
    <Tab title="3. Restrict">
        Create groups of users and define permissions for state accounts to restrict access:
        <RestrictCode />
        [⬆️ Back to Top](#private-transfer-example)
    </Tab>
    <Tab title="4. Deploy">
        Now you’re program is upgraded and ready! Build and deploy to the desired cluster:
        <DeployCode />
        [⬆️ Back to Top](#private-transfer-example)
    </Tab>
    <Tab title="5. Authorize">
        Request an authorization token for user to interact with TEE endpoint:
        <AuthorizeCode />
        [⬆️ Back to Top](#private-transfer-example)
    </Tab>
    <Tab title="6. Test">
        <Construction />
        [⬆️ Back to Top](#private-transfer-example)
    </Tab>

</Tabs>
